# TODO:
- расписать:
- - Функционал для пользователей системы
---
- 

# Фичи
- Админ
- Юзер


# Задача
Cпроектировать и разработать API для системы опросов пользователей.

## Функционал для администратора системы:

- авторизация в системе (регистрация не нужна)
- добавление/изменение/удаление опросов. Атрибуты опроса: название, дата старта, дата окончания, описание. После создания поле "дата старта" у опроса менять нельзя
- добавление/изменение/удаление вопросов в опросе. Атрибуты вопросов: текст вопроса, тип вопроса (ответ текстом, ответ с выбором одного варианта, ответ с выбором нескольких вариантов)

## Функционал для пользователей системы:

- получение списка активных опросов
- прохождение опроса: опросы можно проходить анонимно, в качестве идентификатора пользователя в API передаётся числовой ID, по которому сохраняются ответы пользователя на вопросы; один пользователь может участвовать в любом количестве опросов
- получение пройденных пользователем опросов с детализацией по ответам (что выбрано) по ID уникальному пользователя

## Использовать следующие технологии
- Django 2.2.10
- Django REST framework.

## Результат выполнения задачи
- исходный код приложения в github (только на github, публичный репозиторий)
- инструкция по разворачиванию приложения (в docker или локально)
- документация по API

# Решение задачи
Для отправки запросов я использовал Postman 9~.

## Функционал для администратора системы:
### Авторизация в системе для администратора:
Для начала нужно получить "csrftoken", для чего отправляем GET запрос на `http://{hostname}:{port}/admin/login/`, после берем куки "csrftoken". После этого отправляем POST на `http://{hostname}:{port}/admin/login/?next=/admin/`, указав в теле запроса поля username, password и csrfmiddlewaretoken (в значение последнего вставляем значение из "csrftoken").

После всего этого, указав во вкладке Authorization тип авторизации API Key, вписав в поле Key "X-CSRFToken" и в поле Value значение из csrfmiddlewaretoken, можно обращатиься к сайту как администратор.

### Добавление опросов:
Для добавления нового опроса через API нужно отправить запрос POST на адрес `http://{hostname}:{port}/api/private/surveys/`, указав в body запроса "параметры инициализации" (для тестирования я указывал тип тела запроса как raw + JSON).

![Результат выполнения POST запроса](Screenshot_2021-12-15_19-03-31.png)

### Изменение опросов:
Для изменения опроса через API нужно отправить запрос PUT на адрес `http://{hostname}:{port}/api/private/surveys/{survey's pk}/`, указав в body запроса новые значения объекта модели.

![Результат выполнения PUT запроса](Screenshot_2021-12-15_19-24-18.png)

### Удаление опросов:
Для удаления опроса через API нужно отправить запрос DELETE на адрес `http://{hostname}:{port}/api/private/surveys/{survey's pk}/`.

![Результат выполнения DELETE запроса](Screenshot_2021-12-15_20-01-33.png)

### Добавление вопроса в опросe:
POST запрос на `http://{hostname}:{port}/api/private/questions/`. Нужно указать поля модели.
![Результат выполнения POST запроса](Screenshot_2021-12-15_20-46-59.png)

### Изменение вопроса в опросe:
PUT запрос на `http://{hostname}:{port}/api/private/questions/{question's pk}/`. Нужно указать поля модели.
![Результат выполнения PUT запроса](Screenshot_2021-12-15_21-17-37.png)

### Удаление вопроса в опросe:
DELETE запрос на `http://{hostname}:{port}/api/private/questions/{question's pk}/`. Нужно указать поля модели.
![Результат выполнения DELETE запроса](Screenshot_2021-12-15_21-21-24.png)

## Функционал для пользователя системы:
### Реализация
Были реализованы "Actor"-ы, содержащие уникальный ключь пользователя, и "Session"-ы, содержащий внешний ключ на "Actor" и уникальный ключ сессии. Благодаря этому, у пользователя есть возможность проходить опросы неограниченное колличество опросов.

### Получение списка активных опросов:
GET запрос на `http://{hostname}:{port}/api/public/surveys/`.
![Результат выполнения GET запроса]()

### Прохождение опроса:
Для прохождение опроса нужно сначала получить ключ актора и ключ сессии. Для получение ключа актора нужно выполнить POST запрос на `http://{hostname}:{port}/api/public/actors/`, для получение ключа сессии POST запрос на `http://{hostname}:{port}/api/public/sessions/`. В теле ответа будут пр


POST запрос на `http://{hostname}:{port}/api/public/answer-acts/`. В тело указываем первичный ключ сессии (session, полученный через POST `http://{hostname}:{port}/api/public/sessions/`, в теле которого нужно указать первичный ключ актора (actor)), вариант ответа
![Результат выполнения POST запроса]()

### Получение пройденных опросов:
GET запрос на `http://{hostname}:{port}/api/public/answer-acts/`.
![Результат выполнения GET запроса]()